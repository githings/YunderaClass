# ============================================================================
# Docker Compose ì™„ì „í•œ ì˜ˆì œ - ë³µìŠµìš©
# ============================================================================
# ì´ íŒŒì¼ì€ ì˜¤ëŠ˜ ë°°ìš´ ëª¨ë“  ê°œë…ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.
# ì‹¤ìŠµ íŒŒì¼ì˜ ë¹ˆì¹¸ì„ ì±„ìš¸ ë•Œ ì°¸ê³ í•˜ì„¸ìš”!
# ============================================================================

# ğŸ“Œ 1. ì•± ì´ë¦„ ì •ì˜
# - ì†Œë¬¸ì, ìˆ«ì, í•˜ì´í”ˆ(-), ì–¸ë”ìŠ¤ì½”ì–´(_)ë§Œ ì‚¬ìš© ê°€ëŠ¥
# - CasaOSì—ì„œ ì•±ì„ ì‹ë³„í•˜ëŠ” ê³ ìœ í•œ IDë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤
name: example-app

# ğŸ“Œ 2. Services ì„¹ì…˜
# - Docker Composeì˜ í•µì‹¬! ì‹¤í–‰í•  ì»¨í…Œì´ë„ˆë“¤ì„ ì •ì˜í•©ë‹ˆë‹¤
services:
  
  # ì„œë¹„ìŠ¤ ì´ë¦„ (ììœ ë¡­ê²Œ ì§€ì • ê°€ëŠ¥)
  example-service:
    
    # ğŸ“Œ 2-1. ì´ë¯¸ì§€ ì§€ì •
    # âš ï¸ IMPORTANT: ì ˆëŒ€ :latest íƒœê·¸ ì‚¬ìš© ê¸ˆì§€!
    # âœ… GOOD: linuxserver/app:1.2.3
    # âŒ BAD:  linuxserver/app:latest
    image: linuxserver/example:1.0.0
    
    # ğŸ“Œ 2-2. ì»¨í…Œì´ë„ˆ ì´ë¦„
    # - ì‹¤ì œ Docker ì»¨í…Œì´ë„ˆì˜ ì´ë¦„
    container_name: example-app
    
    # ğŸ“Œ 2-3. ì¬ì‹œì‘ ì •ì±…
    # - unless-stopped: ìˆ˜ë™ìœ¼ë¡œ ì¤‘ì§€í•˜ì§€ ì•ŠëŠ” í•œ í•­ìƒ ì¬ì‹œì‘
    restart: unless-stopped
    
    # ğŸ“Œ 2-4. ì‚¬ìš©ì ê¶Œí•œ ì„¤ì •
    # ğŸ”‘ KEY CONCEPT: ê¶Œí•œ ì „ëµ
    # 
    # Case 1: ì‚¬ìš©ì ë””ë ‰í† ë¦¬(/DATA/Documents, /DATA/Downloads ë“±) ì ‘ê·¼
    #   â†’ user: $PUID:$PGID í•„ìˆ˜!
    #
    # Case 2: AppDataë§Œ ì‚¬ìš© (/DATA/AppData/ì•±ì´ë¦„/)
    #   â†’ user ì§€ì • ì•ˆ í•´ë„ ë¨ (CasaOSê°€ ìë™ìœ¼ë¡œ PUID:PGID ì ìš©)
    #   â†’ íŠ¹ë³„íˆ rootê°€ í•„ìš”í•œ ê²½ìš°: user: "0:0" ëª…ì‹œ
    #
    # Case 3: í˜¼í•© ì‚¬ìš© (AppData + ì‚¬ìš©ì ë””ë ‰í† ë¦¬)
    #   â†’ user: $PUID:$PGID í•„ìˆ˜!
    user: $PUID:$PGID
    
    # ğŸ“Œ 2-5. í¬íŠ¸ ë…¸ì¶œ
    # ğŸŒ NSL Router í†µí•© (ì¤‘ìš”!)
    # 
    # âœ… GOOD: expose ì‚¬ìš© (ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì—ë§Œ ë…¸ì¶œ)
    #   - NSL Routerê°€ ìë™ìœ¼ë¡œ HTTPS ë„ë©”ì¸ ìƒì„±
    #   - ì˜ˆ: https://example-username.nsl.sh
    #
    # âš ï¸ ports ì‚¬ìš©ì€ íŠ¹ë³„í•œ ê²½ìš°ë§Œ!
    #   - Torrent í¬íŠ¸, API í¬íŠ¸ ë“± ì§ì ‘ ì ‘ê·¼ì´ í•„ìš”í•œ ê²½ìš°
    expose:
      - 8080
    
    # portsë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° (ì„ íƒì )
    # ports:
    #   - "6881:6881"      # Torrent í¬íŠ¸ ì˜ˆì‹œ
    #   - "6881:6881/udp"  # UDP í¬íŠ¸ ì˜ˆì‹œ
    
    # ğŸ“Œ 2-6. í™˜ê²½ ë³€ìˆ˜
    # ğŸ’¡ CasaOS ì‹œìŠ¤í…œ ë³€ìˆ˜ë“¤:
    #   - $PUID, $PGID: ì‚¬ìš©ì/ê·¸ë£¹ ID (ë³´í†µ 1000:1000)
    #   - $TZ: ì‹œìŠ¤í…œ íƒ€ì„ì¡´
    #   - $default_pwd: CasaOSê°€ ìƒì„±í•œ ê¸°ë³¸ ë¹„ë°€ë²ˆí˜¸
    #   - $AppID: ì•± ì´ë¦„ (name ê°’ê³¼ ë™ì¼)
    environment:
      - TZ=$TZ                          # íƒ€ì„ì¡´ ì„¤ì •
      - PUID=$PUID                      # ì‚¬ìš©ì ID
      - PGID=$PGID                      # ê·¸ë£¹ ID
      - WEBUI_PORT=8080                 # ì›¹ UI í¬íŠ¸ (ì•±ë§ˆë‹¤ ë‹¤ë¦„)
      - PASSWORD=$default_pwd           # ê¸°ë³¸ ë¹„ë°€ë²ˆí˜¸
    
    # ğŸ“Œ 2-7. ë³¼ë¥¨ ë§¤í•‘
    # ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°:
    #   /DATA/
    #   â”œâ”€â”€ AppData/[ì•±ì´ë¦„]/     â† ì•± ì „ìš© ë°ì´í„° (ì„¤ì •, DB ë“±)
    #   â”œâ”€â”€ Documents/             â† ì‚¬ìš©ì ë¬¸ì„œ
    #   â”œâ”€â”€ Downloads/             â† ë‹¤ìš´ë¡œë“œ í´ë”
    #   â”œâ”€â”€ Gallery/               â† ì‚¬ì§„/ì´ë¯¸ì§€
    #   â””â”€â”€ Media/                 â† ë¯¸ë””ì–´ íŒŒì¼
    #       â”œâ”€â”€ Movies/
    #       â”œâ”€â”€ Music/
    #       â””â”€â”€ TV Shows/
    volumes:
      # ì•± ì„¤ì • ë””ë ‰í† ë¦¬ (í•„ìˆ˜!)
      - /DATA/AppData/$AppID/config:/app/config
      
      # ë°ì´í„°ë² ì´ìŠ¤ (í•„ìš”ì‹œ)
      - /DATA/AppData/$AppID/data:/app/data
      
      # ì‚¬ìš©ì ë””ë ‰í† ë¦¬ ì ‘ê·¼ (í•„ìš”ì‹œ)
      - /DATA/Downloads:/downloads
      - /DATA/Documents:/documents:ro  # :ro = ì½ê¸° ì „ìš©
    
    # ğŸ“Œ 2-8. CPU ê³µìœ  ì„¤ì • (í•„ìˆ˜!)
    # ğŸ¯ CPU ìš°ì„ ìˆœìœ„ ê°€ì´ë“œ:
    #   100: ì‹œìŠ¤í…œ í¬ë¦¬í‹°ì»¬ (ì˜ˆì•½)
    #   90:  ê´€ë¦¬ ë„êµ¬ (CasaOS, Portainer)
    #   80:  ì‚¬ìš©ì ëŒ€ë©´ ì¸í„°ë™í‹°ë¸Œ (ì›¹ ì„œë²„, API)
    #   70:  ë¬´ê±°ìš´ ì‘ì—…ì´ ìˆëŠ” ì¸í„°ë™í‹°ë¸Œ (Nextcloud)
    #   50:  ì¼ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ (ëŒ€ë¶€ë¶„ì˜ ì•±)
    #   30:  ë°±ê·¸ë¼ìš´ë“œ ì„œë¹„ìŠ¤ (ë°±ì—…, ë¡œê·¸)
    #   20:  ë¬´ê±°ìš´ ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ (ML, íŠ¸ëœìŠ¤ì½”ë”©)
    #   10:  ì‹œìŠ¤í…œ ë°±ê·¸ë¼ìš´ë“œ (ì˜ˆì•½)
    cpu_shares: 50
    
    # ğŸ“Œ 2-9. ë¦¬ì†ŒìŠ¤ ì œí•œ (ì„ íƒì )
    # âš ï¸ ëŒ€ë¶€ë¶„ì˜ ì•±ì€ í•„ìš” ì—†ìŒ!
    # ë¦¬ì†ŒìŠ¤ ê³ ê°ˆì„ ë°©ì§€í•´ì•¼ í•˜ëŠ” íŠ¹ë³„í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš©
    # deploy:
    #   resources:
    #     limits:
    #       memory: 512M        # ë©”ëª¨ë¦¬ ì œí•œ
    #       cpus: '1.0'         # CPU ì œí•œ
    
    # ğŸ“Œ 2-10. í—¬ìŠ¤ì²´í¬ (ì„ íƒì )
    # ì»¨í…Œì´ë„ˆê°€ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸
    healthcheck:
      test: ["CMD", "wget", "--spider", "--tries=1", "http://localhost:8080/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s

# ============================================================================
# ğŸ“Œ 3. CasaOS ë©”íƒ€ë°ì´í„° (x-casaos)
# ============================================================================
# CasaOS ì•± ìŠ¤í† ì–´ì— í‘œì‹œë˜ëŠ” ì •ë³´ë“¤

x-casaos:
  
  # ğŸ“Œ 3-1. í•„ìˆ˜ í•„ë“œ
  
  # ë©”ì¸ ì„œë¹„ìŠ¤ ì´ë¦„ (services ì•„ë˜ì˜ ì„œë¹„ìŠ¤ ì´ë¦„ê³¼ ì¼ì¹˜í•´ì•¼ í•¨)
  main: example-service
  
  # ì›¹ UI í¬íŠ¸ (exposeí•œ í¬íŠ¸ì™€ ì¼ì¹˜í•´ì•¼ í•¨)
  webui_port: 8080
  
  # ì§€ì› ì•„í‚¤í…ì²˜
  architectures:
    - amd64
    - arm64
    # - arm      # 32ë¹„íŠ¸ ARM (ì„ íƒì )
  
  # ğŸ“Œ 3-2. ì„¤ì¹˜ ì „ ëª…ë ¹ì–´ (ì„ íƒì )
  # ğŸ”§ ì‚¬ìš© ì˜ˆì‹œ:
  #   - ê¸°ë³¸ ì„¤ì • íŒŒì¼ ìƒì„±
  #   - ë””ë ‰í† ë¦¬ ê¶Œí•œ ì„¤ì •
  #   - ì´ˆê¸° ì‚¬ìš©ì ê³„ì • ìƒì„±
  #
  # âš ï¸ ë³´ì•ˆ ìš”êµ¬ì‚¬í•­:
  #   - ì ˆëŒ€ :latest íƒœê·¸ ì‚¬ìš© ê¸ˆì§€! (íŠ¹ì • ë²„ì „ ëª…ì‹œ)
  #   - ì‚¬ìš©ì ë””ë ‰í† ë¦¬ ì‘ì—… ì‹œ --user $PUID:$PGID ì‚¬ìš©
  #   - ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰í•´ë„ ì•ˆì „í•˜ë„ë¡ ì‘ì„± (ë©±ë“±ì„±)
  pre-install-cmd: |
    mkdir -p /DATA/AppData/$AppID/config &&
    docker run --rm \
      -v /DATA/AppData/$AppID:/data \
      --user $PUID:$PGID \
      ubuntu:22.04 \
      chown -R $PUID:$PGID /data
  
  # ğŸ“Œ 3-3. ì•± ì •ë³´
  
  author: Yundera Team
  developer: Example Developer
  category: Utilities
  
  # ì•„ì´ì½˜ (í•„ìˆ˜!)
  icon: https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/Example/icon.png
  
  # ìŠ¤í¬ë¦°ìƒ· (ìµœì†Œ 1ê°œ í•„ìˆ˜!)
  screenshot_link:
    - https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/Example/screenshot-1.png
    - https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/Example/screenshot-2.png
  
  # ì¸ë„¤ì¼ (ì„ íƒì , Featured ì•±ë§Œ)
  thumbnail: https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/Example/thumbnail.png
  
  # ğŸ“Œ 3-4. ë‹¤êµ­ì–´ ì§€ì› (í•„ìˆ˜!)
  # âš ï¸ ìµœì†Œ 5ê°œ ì–¸ì–´ í•„ìš”: en_us, ko_kr, zh_cn, fr_fr, es_es
  
  # ì•± ì œëª©
  title:
    en_us: Example Application
  
  # íƒœê·¸ë¼ì¸ (í•œ ì¤„ ì„¤ëª…)
  tagline:
    en_us: A powerful example application for demonstration purposes
    ko_kr: ë°ëª¨ ëª©ì ì˜ ê°•ë ¥í•œ ì˜ˆì œ ì• í”Œë¦¬ì¼€ì´ì…˜
    zh_cn: ç”¨äºæ¼”ç¤ºç›®çš„çš„å¼ºå¤§ç¤ºä¾‹åº”ç”¨ç¨‹åº
    fr_fr: Une application exemple puissante Ã  des fins de dÃ©monstration
    es_es: Una potente aplicaciÃ³n de ejemplo con fines de demostraciÃ³n
  
  # ìƒì„¸ ì„¤ëª…
  description:
    en_us: |
      This is a comprehensive example application that demonstrates all the key concepts
      of Docker Compose integration with CasaOS. It includes proper permission handling,
      NSL Router integration, and follows all best practices.
    ko_kr: |
      ì´ê²ƒì€ CasaOSì™€ Docker Compose í†µí•©ì˜ ëª¨ë“  í•µì‹¬ ê°œë…ì„ ë³´ì—¬ì£¼ëŠ”
      ì¢…í•©ì ì¸ ì˜ˆì œ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. ì ì ˆí•œ ê¶Œí•œ ì²˜ë¦¬, NSL Router í†µí•©,
      ëª¨ë“  ëª¨ë²” ì‚¬ë¡€ë¥¼ ë”°ë¦…ë‹ˆë‹¤.
    zh_cn: |
      è¿™æ˜¯ä¸€ä¸ªå…¨é¢çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæ¼”ç¤ºäº†Docker Composeä¸CasaOSé›†æˆçš„
      æ‰€æœ‰å…³é”®æ¦‚å¿µã€‚å®ƒåŒ…æ‹¬é€‚å½“çš„æƒé™å¤„ç†ã€NSL Routeré›†æˆï¼Œ
      å¹¶éµå¾ªæ‰€æœ‰æœ€ä½³å®è·µã€‚
    fr_fr: |
      Il s'agit d'une application exemple complÃ¨te qui dÃ©montre tous les concepts clÃ©s
      de l'intÃ©gration de Docker Compose avec CasaOS. Elle inclut une gestion appropriÃ©e
      des permissions, l'intÃ©gration NSL Router et suit toutes les meilleures pratiques.
    es_es: |
      Esta es una aplicaciÃ³n de ejemplo completa que demuestra todos los conceptos clave
      de la integraciÃ³n de Docker Compose con CasaOS. Incluye manejo adecuado de permisos,
      integraciÃ³n NSL Router y sigue todas las mejores prÃ¡cticas.
  
  # ğŸ“Œ 3-5. ì„¤ì¹˜ ì „ ì•ˆë‚´ (ì„ íƒì )
  # ì‚¬ìš©ìì—ê²Œ ê¸°ë³¸ ê³„ì • ì •ë³´ ë“±ì„ ì•Œë ¤ì¤„ ë•Œ ì‚¬ìš©
  tips:
    before_install:
      en_us: |
        **Default Account**
        
        | Username | Password |
        | -------- | -------- |
        | `admin`  | `$default_pwd` |
        
        Access via: `https://example-[username].nsl.sh`
  
  # ì›¹ UI ì§„ì…ì  ê²½ë¡œ
  index: /
  
  # ì•± ìŠ¤í† ì–´ ID (nameê³¼ ë™ì¼)
  store_app_id: example-app
  
  # ê´€ë¦¬ë˜ì§€ ì•ŠëŠ” ì•±ì¸ì§€ ì—¬ë¶€ (ë³´í†µ false)
  is_uncontrolled: false

# ============================================================================
# ğŸ“š í•µì‹¬ ê°œë… ìš”ì•½
# ============================================================================
#
# 1. ì´ë¯¸ì§€ëŠ” í•­ìƒ íŠ¹ì • ë²„ì „ íƒœê·¸ ì‚¬ìš©! (:latest ê¸ˆì§€)
#
# 2. ê¶Œí•œ ì„¤ì • (user):
#    - ì‚¬ìš©ì ë””ë ‰í† ë¦¬ ì ‘ê·¼ ì‹œ: user: $PUID:$PGID
#    - AppDataë§Œ ì‚¬ìš©: user ìƒëµ ê°€ëŠ¥ (ìë™ ì ìš©)
#    - root í•„ìš” ì‹œ: user: "0:0" ëª…ì‹œ
#
# 3. í¬íŠ¸ ë…¸ì¶œ:
#    - ì›¹ UI: expose ì‚¬ìš© (NSL Routerê°€ HTTPS ì²˜ë¦¬)
#    - ê¸°íƒ€ í¬íŠ¸: ports ì‚¬ìš© (ì§ì ‘ ì ‘ê·¼ í•„ìš” ì‹œ)
#
# 4. CPU shares í•„ìˆ˜! (50ì´ ê¸°ë³¸ê°’)
#
# 5. ë³¼ë¥¨ì€ í•­ìƒ /DATA ì•„ë˜ì— ë§¤í•‘
#    - ì•± ë°ì´í„°: /DATA/AppData/$AppID/
#    - ì‚¬ìš©ì ë°ì´í„°: /DATA/Documents, /DATA/Downloads ë“±
#
# 6. x-casaos ë©”íƒ€ë°ì´í„°:
#    - main, webui_portëŠ” í•„ìˆ˜!
#    - ë‹¤êµ­ì–´ ì§€ì› (ìµœì†Œ 5ê°œ ì–¸ì–´)
#    - asset URLì€ Yundera ë ˆí¬ì§€í† ë¦¬ë¡œ
#
# ============================================================================
# ğŸ“ í•™ìŠµ íŒ
# ============================================================================
#
# 1. ì´ íŒŒì¼ì„ ì°¸ê³ í•˜ì—¬ ì‹¤ìŠµ íŒŒì¼ì˜ ë¹ˆì¹¸ì„ ì±„ìš°ì„¸ìš”
# 2. ê° ì„¹ì…˜ì˜ ì£¼ì„ì„ ê¼¼ê¼¼íˆ ì½ì–´ë³´ì„¸ìš”
# 3. ì‹¤ì œ ì•±ë“¤ì€ ì´ êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì„¸ë¶€ì‚¬í•­ë§Œ ë‹¤ë¦…ë‹ˆë‹¤
# 4. ë§‰íˆëŠ” ë¶€ë¶„ì´ ìˆìœ¼ë©´ ì´ íŒŒì¼ë¡œ ëŒì•„ì™€ì„œ í™•ì¸í•˜ì„¸ìš”!
#
# í™”ì´íŒ…! ğŸ’ª
# ============================================================================
